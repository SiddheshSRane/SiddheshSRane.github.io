document.addEventListener('DOMContentLoaded',function(){try{if(window.AOS&&window.matchMedia&&window.matchMedia('(prefers-reduced-motion: no-preference)').matches&&window.innerWidth>640){AOS.init({duration:800,once:true})}}catch(e){}const y=document.getElementById('year');if(y)y.textContent=new Date().getFullYear()});const moveTopBtn=document.getElementById('moveTopBtn'),navbar=document.querySelector('.navbar'),navLinks=document.querySelectorAll('.nav-link'),sections=document.querySelectorAll('section[id]');function updateMoveTop(){if(!moveTopBtn)return;const s=document.body.scrollTop>200||document.documentElement.scrollTop>200;if(s){moveTopBtn.style.display='flex';moveTopBtn.classList.add('show')}else{moveTopBtn.classList.remove('show');setTimeout(()=>{if(!moveTopBtn.classList.contains('show'))moveTopBtn.style.display='none'},200)}}function onScroll(){if(navbar){window.scrollY>20?navbar.classList.add('scrolled'):navbar.classList.remove('scrolled')}const s=window.scrollY+(window.innerHeight>800?140:120);sections.forEach(sec=>{const t=sec.offsetTop,b=t+sec.offsetHeight;if(s>=t&&s<b){navLinks.forEach(l=>l.classList.remove('active'));const a=document.querySelector('.nav-link[href="#'+sec.id+'"]');if(a)a.classList.add('active')}});updateMoveTop()}let ticking=false;window.addEventListener('scroll',()=>{if(!ticking){window.requestAnimationFrame(()=>{onScroll();ticking=false});ticking=true}},{passive:true});document.addEventListener('DOMContentLoaded',onScroll);if(moveTopBtn)moveTopBtn.addEventListener('click',()=>{window.scrollTo({top:0,behavior:'smooth'})});(function(){const k='site-theme',r=document.documentElement,s=localStorage.getItem(k);function a(t){t==='light'?r.setAttribute('data-theme','light'):r.removeAttribute('data-theme')}a(s);const t=document.querySelector('#themeToggle');if(t){t.addEventListener('click',()=>{const n=localStorage.getItem(k)==='light'?'dark':'light';localStorage.setItem(k,n==='light'?'light':'');a(n==='light'?'light':null);t.setAttribute('aria-pressed',n==='light')})}})();
